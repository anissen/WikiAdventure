<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>WikiAdventure: Project/LuaFunctions.h Source File</title>
<link href="stylesheet.css" rel="stylesheet" type="text/css">
</head>

<body>
<!-- Generated by Doxygen 1.4.2 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<div class="nav">
<a class="el" href="dir_000001.html">Project</a></div>
<h1>LuaFunctions.h</h1><a href="_lua_functions_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 
00002 <span class="preprocessor">#include "../WA-SDL/Globals.h"</span>
00003 <span class="preprocessor">#include "../WA-SDL/EngineMain.h"</span>
00004 <span class="preprocessor">#include "../WA-SDL/SDLStateGameMenu.h"</span>
00005 
00006 <span class="preprocessor">#include "..\\Lua\\LuaPlus.h"</span>
00007 <span class="keyword">using</span> <span class="keyword">namespace </span>LuaPlus;
00008 
00009 <span class="comment">/*</span>
00010 <span class="comment">#include &lt;iostream&gt;</span>
00011 <span class="comment">using std::cout;</span>
00012 <span class="comment">using std::cin;</span>
00013 <span class="comment">using std::endl;</span>
00014 <span class="comment">*/</span>
00015 
00016 
<a name="l00021"></a><a class="code" href="_lua_functions_8h.html#a0">00021</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="_lua_functions_8h.html#a0">LuaPrint</a>( LuaState* State )
00022 {
00023     LuaStack args( State );
00024 
00025     <a class="code" href="_main_8cpp.html#a0">pEngine</a>-&gt;<a class="code" href="class_c_my_engine.html#a6">GetDebugOverlay</a>()-&gt;AddInfo( <span class="stringliteral">"The following is printed using Lua scripting: "</span> );
00026     <a class="code" href="_main_8cpp.html#a0">pEngine</a>-&gt;<a class="code" href="class_c_my_engine.html#a6">GetDebugOverlay</a>()-&gt;AddWarning( args[1].GetString() );
00027 
00028     <span class="keywordflow">return</span> 1;
00029 }
00030 
<a name="l00031"></a><a class="code" href="_lua_functions_8h.html#a1">00031</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="_lua_functions_8h.html#a1">LuaStartDialog</a>( LuaState* State )
00032 {
00033     LuaStack args( State );
00034 
00035     <a class="code" href="_main_8cpp.html#a0">pEngine</a>-&gt;<a class="code" href="class_c_my_engine.html#a4">GetCurrentLocation</a>()-&gt;StartDialog( args[1].GetString() );
00036 
00037     <span class="keywordflow">return</span> 1;
00038 }
00039 
<a name="l00040"></a><a class="code" href="_lua_functions_8h.html#a2">00040</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="_lua_functions_8h.html#a2">LuaHideThisItem</a>( LuaState* State )
00041 {
00042     <a class="code" href="_main_8cpp.html#a0">pEngine</a>-&gt;<a class="code" href="class_c_my_engine.html#a3">GetCurrentItem</a>()-&gt;SetVisible( <span class="keyword">false</span> );
00043 
00044     <span class="keywordflow">return</span> 1;
00045 }
00046 
00047 <span class="comment">//static int LuaShowThisItem( LuaState* State )</span>
00048 <span class="comment">//{</span>
00049 <span class="comment">//  pEngine-&gt;GetCurrentItem()-&gt;SetVisible( true );</span>
00050 <span class="comment">//</span>
00051 <span class="comment">//  return 1;</span>
00052 <span class="comment">//}</span>
00053 
<a name="l00054"></a><a class="code" href="_lua_functions_8h.html#a3">00054</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="_lua_functions_8h.html#a3">LuaStartLocation</a>( LuaState* State )
00055 {
00056     LuaStack args( State );
00057 
00058     string sLocation = args[1].GetString();
00059 
00060     <a class="code" href="_w_a-_s_d_l_2_globals_8h.html#a2">DebugInfo</a>( <a class="code" href="_w_a-_s_d_l_2_globals_8h.html#a12a6">TypeInfo</a>, string(<span class="stringliteral">"Loading location \""</span> + sLocation + <span class="stringliteral">"\""</span>).c_str() );
00061 
00062     <a class="code" href="_main_8cpp.html#a0">pEngine</a>-&gt;<a class="code" href="class_c_my_engine.html#a11">GetLuaScriptHandler</a>()-&gt;DoLuaScript( <span class="stringliteral">"Location = \""</span> + sLocation + <span class="stringliteral">"\""</span> );
00063     <a class="code" href="_main_8cpp.html#a0">pEngine</a>-&gt;<a class="code" href="class_c_my_engine.html#a11">GetLuaScriptHandler</a>()-&gt;DoLuaScript( <span class="stringliteral">"SaveGame()"</span> );
00064 
00065     <a class="code" href="class_c_s_d_l_state_location.html">CSDLStateLocation</a>* pLocation = <span class="keyword">new</span> <a class="code" href="class_c_s_d_l_state_location.html">CSDLStateLocation</a>;
00066     <a class="code" href="_main_8cpp.html#a0">pEngine</a>-&gt;<a class="code" href="class_c_my_engine.html#a12">GetStateHandler</a>()-&gt;NewLayerDelayedClear( pLocation );
00067     pLocation-&gt;<a class="code" href="class_c_s_d_l_state_location.html#a2">Load</a>( <a class="code" href="_main_8cpp.html#a0">pEngine</a>-&gt;<a class="code" href="class_c_my_engine.html#a8">GetGameHandler</a>()-&gt;GetLoadedGame()-&gt;GetLocations()-&gt;GetLocation( sLocation ) );
00068 
00069     <a class="code" href="_main_8cpp.html#a0">pEngine</a>-&gt;<a class="code" href="class_c_my_engine.html#a19">SetInGame</a>( <span class="keyword">true</span> );
00070     <a class="code" href="_main_8cpp.html#a0">pEngine</a>-&gt;<a class="code" href="class_c_my_engine.html#a17">SetCurrentLocationName</a>( sLocation );
00071 
00072     <span class="keywordflow">return</span> 1;
00073 }
00074 
<a name="l00075"></a><a class="code" href="_lua_functions_8h.html#a4">00075</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="_lua_functions_8h.html#a4">LuaSaveGame</a>( LuaState* State )
00076 {
00077     <a class="code" href="_main_8cpp.html#a0">pEngine</a>-&gt;<a class="code" href="class_c_my_engine.html#a11">GetLuaScriptHandler</a>()-&gt;DumpToFile( <span class="stringliteral">"Media\\"</span> + <a class="code" href="_main_8cpp.html#a0">pEngine</a>-&gt;<a class="code" href="class_c_my_engine.html#a7">GetGameDir</a>() + <span class="stringliteral">"\\SaveGame.was"</span> );
00078     <a class="code" href="_w_a-_s_d_l_2_globals_8h.html#a2">DebugInfo</a>( <a class="code" href="_w_a-_s_d_l_2_globals_8h.html#a12a6">TypeInfo</a>, <span class="stringliteral">"Game saved"</span> );
00079 
00080     <span class="keywordflow">return</span> 1;
00081 }
00082 
<a name="l00083"></a><a class="code" href="_lua_functions_8h.html#a5">00083</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="_lua_functions_8h.html#a5">LuaBackToGameMenu</a>( LuaState* State )
00084 {
00085     <a class="code" href="_main_8cpp.html#a0">pEngine</a>-&gt;<a class="code" href="class_c_my_engine.html#a11">GetLuaScriptHandler</a>()-&gt;DoLuaScript( <span class="stringliteral">"SaveGame()"</span> );
00086     <a class="code" href="_main_8cpp.html#a0">pEngine</a>-&gt;<a class="code" href="class_c_my_engine.html#a12">GetStateHandler</a>()-&gt;NewLayerDelayedClear( <span class="keyword">new</span> <a class="code" href="class_c_s_d_l_state_game_menu.html">CSDLStateGameMenu</a> );
00087 
00088     <span class="keywordflow">return</span> 1;
00089 }
00090 
<a name="l00091"></a><a class="code" href="_lua_functions_8h.html#a6">00091</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="_lua_functions_8h.html#a6">LuaHideThisDialog</a>( LuaState* State )
00092 {
00093     <a class="code" href="_main_8cpp.html#a0">pEngine</a>-&gt;<a class="code" href="class_c_my_engine.html#a1">GetCurrentDialog</a>()-&gt;SetVisible( <span class="keyword">false</span> );
00094 
00095     <span class="keywordflow">return</span> 1;
00096 }
00097 
00098 <span class="comment">//static int LuaShowThisDialog( LuaState* State )</span>
00099 <span class="comment">//{</span>
00100 <span class="comment">//  pEngine-&gt;GetCurrentDialog()-&gt;SetVisible( true );</span>
00101 <span class="comment">//</span>
00102 <span class="comment">//  return 1;</span>
00103 <span class="comment">//}</span>
00104 
<a name="l00105"></a><a class="code" href="_lua_functions_8h.html#a7">00105</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="_lua_functions_8h.html#a7">LuaChangeDialogText</a>( LuaState* State )
00106 {
00107     LuaStack args( State );
00108     <a class="code" href="_main_8cpp.html#a0">pEngine</a>-&gt;<a class="code" href="class_c_my_engine.html#a1">GetCurrentDialog</a>()-&gt;SetText( args[1].GetString() );
00109 
00110     <span class="keywordflow">return</span> 1;
00111 }
00112 
<a name="l00113"></a><a class="code" href="_lua_functions_8h.html#a8">00113</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="_lua_functions_8h.html#a8">LuaShowMessageBox</a>( LuaState* State )
00114 {
00115     LuaStack args( State );
00116 
00117     string sTitle   = args[1].GetString();
00118     string sText    = <a class="code" href="_util_8h.html#a8">ReplaceBR</a>( args[2].GetString() );
00119 
00120     <span class="keywordflow">if</span> ( args[3].IsNone() ) {
00121         <a class="code" href="_main_8cpp.html#a0">pEngine</a>-&gt;<a class="code" href="class_c_my_engine.html#a12">GetStateHandler</a>()-&gt;PushLayer( <span class="keyword">new</span> <a class="code" href="class_c_s_d_l_state_message_box.html">CSDLStateMessageBox</a>( sTitle, sText ) );
00122     } <span class="keywordflow">else</span> {
00123         string sOnExitScript = <a class="code" href="_util_8h.html#a8">ReplaceBR</a>( args[3].GetString() );
00124         <a class="code" href="_main_8cpp.html#a0">pEngine</a>-&gt;<a class="code" href="class_c_my_engine.html#a12">GetStateHandler</a>()-&gt;PushLayer( <span class="keyword">new</span> <a class="code" href="class_c_s_d_l_state_message_box.html">CSDLStateMessageBox</a>( sTitle, sText, sOnExitScript ) );
00125     }
00126 
00127     <span class="keywordflow">return</span> 1;
00128 }
00129 
<a name="l00130"></a><a class="code" href="_lua_functions_8h.html#a9">00130</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="_lua_functions_8h.html#a9">LuaShowQuestionBox</a>( LuaState* State )
00131 {
00132     LuaStack args( State );
00133 
00134     string sTitle   = args[1].GetString();
00135     string sText    = <a class="code" href="_util_8h.html#a8">ReplaceBR</a>( args[2].GetString() );
00136 
00137     <span class="keywordflow">if</span> ( args[3].IsNone() ) {
00138         <a class="code" href="_main_8cpp.html#a0">pEngine</a>-&gt;<a class="code" href="class_c_my_engine.html#a12">GetStateHandler</a>()-&gt;PushLayer( <span class="keyword">new</span> <a class="code" href="class_c_s_d_l_state_question_box.html">CSDLStateQuestionBox</a>( sTitle, sText ) );
00139     } 
00140     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( args[4].IsNone() ) 
00141     {
00142         string sOnYesScript = <a class="code" href="_util_8h.html#a8">ReplaceBR</a>( args[3].GetString() );
00143         <a class="code" href="_main_8cpp.html#a0">pEngine</a>-&gt;<a class="code" href="class_c_my_engine.html#a12">GetStateHandler</a>()-&gt;PushLayer( <span class="keyword">new</span> <a class="code" href="class_c_s_d_l_state_question_box.html">CSDLStateQuestionBox</a>( sTitle, sText, sOnYesScript ) );
00144     }
00145     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( args[5].IsNone() )
00146     {
00147         string sOnYesScript = <a class="code" href="_util_8h.html#a8">ReplaceBR</a>( args[3].GetString() );
00148         string sOnNoScript  = <a class="code" href="_util_8h.html#a8">ReplaceBR</a>( args[4].GetString() );
00149         <a class="code" href="_main_8cpp.html#a0">pEngine</a>-&gt;<a class="code" href="class_c_my_engine.html#a12">GetStateHandler</a>()-&gt;PushLayer( <span class="keyword">new</span> <a class="code" href="class_c_s_d_l_state_question_box.html">CSDLStateQuestionBox</a>( sTitle, sText, sOnYesScript, sOnNoScript ) );
00150     } <span class="keywordflow">else</span> {
00151         <a class="code" href="_w_a-_s_d_l_2_globals_8h.html#a2">DebugInfo</a>( <a class="code" href="_w_a-_s_d_l_2_globals_8h.html#a12a8">TypeError</a>, <span class="stringliteral">"Wrong number of arguments passed to script"</span> );
00152     }
00153 
00154     <span class="keywordflow">return</span> 1;
00155 }
00156 
<a name="l00157"></a><a class="code" href="_lua_functions_8h.html#a10">00157</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="_lua_functions_8h.html#a10">LuaShowPicture</a>( LuaState* State )
00158 {
00159     LuaStack args( State );
00160 
00161     string sPicture = args[1].GetString();
00162 
00163     <span class="keywordflow">if</span> ( args[2].IsNone() ) {
00164         <a class="code" href="_main_8cpp.html#a0">pEngine</a>-&gt;<a class="code" href="class_c_my_engine.html#a12">GetStateHandler</a>()-&gt;PushLayer( <span class="keyword">new</span> <a class="code" href="class_c_s_d_l_state_show_picture.html">CSDLStateShowPicture</a>( sPicture ) );
00165     } <span class="keywordflow">else</span> {
00166         string sOnExitScript = <a class="code" href="_util_8h.html#a8">ReplaceBR</a>( args[2].GetString() );
00167         <a class="code" href="_main_8cpp.html#a0">pEngine</a>-&gt;<a class="code" href="class_c_my_engine.html#a12">GetStateHandler</a>()-&gt;PushLayer( <span class="keyword">new</span> <a class="code" href="class_c_s_d_l_state_show_picture.html">CSDLStateShowPicture</a>( sPicture, sOnExitScript) );
00168     }
00169 
00170     <span class="keywordflow">return</span> 1;
00171 }
00172 
00173 <span class="comment">/*</span>
00174 <span class="comment">static void LuaShowText( const char* sText = "Hello World", const char* sOnExitScript = "" )</span>
00175 <span class="comment">{</span>
00176 <span class="comment">    //string sText = ReplaceInText( args[1].GetString(), "&lt;br&gt;", "\n" );</span>
00177 <span class="comment"></span>
00178 <span class="comment">    if ( string(sOnExitScript).length() == 0 ) {</span>
00179 <span class="comment">        pEngine-&gt;GetStateHandler()-&gt;PushLayer( new CSDLStateShowText( sText ) );</span>
00180 <span class="comment">    } else {</span>
00181 <span class="comment">        //string sOnExitScript = ReplaceInText( args[2].GetString(), "&lt;br&gt;", "\n" );</span>
00182 <span class="comment">        pEngine-&gt;GetStateHandler()-&gt;PushLayer( new CSDLStateShowText( sText, sOnExitScript ) );</span>
00183 <span class="comment">    }</span>
00184 <span class="comment">}</span>
00185 <span class="comment">*/</span>
00186 
<a name="l00187"></a><a class="code" href="_lua_functions_8h.html#a11">00187</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="_lua_functions_8h.html#a11">LuaShowText</a>( LuaState* State )
00188 {
00189     LuaStack args( State );
00190 
00191     string sText = <a class="code" href="_util_8h.html#a8">ReplaceBR</a>( args[1].GetString() );
00192 
00193     <span class="keywordflow">if</span> ( args[2].IsNone() ) {
00194         <a class="code" href="_main_8cpp.html#a0">pEngine</a>-&gt;<a class="code" href="class_c_my_engine.html#a12">GetStateHandler</a>()-&gt;PushLayer( <span class="keyword">new</span> <a class="code" href="class_c_s_d_l_state_show_text.html">CSDLStateShowText</a>( sText ) );
00195     } <span class="keywordflow">else</span> {
00196         string sOnExitScript = <a class="code" href="_util_8h.html#a8">ReplaceBR</a>( args[2].GetString() );
00197         <a class="code" href="_main_8cpp.html#a0">pEngine</a>-&gt;<a class="code" href="class_c_my_engine.html#a12">GetStateHandler</a>()-&gt;PushLayer( <span class="keyword">new</span> <a class="code" href="class_c_s_d_l_state_show_text.html">CSDLStateShowText</a>( sText, sOnExitScript ) );
00198     }
00199 
00200     <span class="keywordflow">return</span> 1;
00201 }
00202 
<a name="l00203"></a><a class="code" href="_lua_functions_8h.html#a12">00203</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="_lua_functions_8h.html#a12">LuaEndDialog</a>( LuaState* State )
00204 {
00205     <span class="keywordflow">if</span> ( <a class="code" href="_main_8cpp.html#a0">pEngine</a>-&gt;<a class="code" href="class_c_my_engine.html#a2">GetCurrentDialogList</a>() != 0 ) {
00206         <a class="code" href="_main_8cpp.html#a0">pEngine</a>-&gt;<a class="code" href="class_c_my_engine.html#a12">GetStateHandler</a>()-&gt;DelayedPopLayer( <a class="code" href="_main_8cpp.html#a0">pEngine</a>-&gt;<a class="code" href="class_c_my_engine.html#a2">GetCurrentDialogList</a>() );
00207     }
00208 
00209     <span class="keywordflow">return</span> 1;
00210 }
00211 
<a name="l00212"></a><a class="code" href="_lua_functions_8h.html#a13">00212</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="_lua_functions_8h.html#a13">LuaEndDialogThread</a>( LuaState* State )
00213 {
00214     <span class="keywordflow">if</span> ( <a class="code" href="_main_8cpp.html#a0">pEngine</a>-&gt;<a class="code" href="class_c_my_engine.html#a2">GetCurrentDialogList</a>() != 0 ) {
00215         <a class="code" href="_main_8cpp.html#a0">pEngine</a>-&gt;<a class="code" href="class_c_my_engine.html#a2">GetCurrentDialogList</a>()-&gt;NewDialog( <a class="code" href="_main_8cpp.html#a0">pEngine</a>-&gt;<a class="code" href="class_c_my_engine.html#a2">GetCurrentDialogList</a>()-&gt;GetMainDialog() );
00216     }
00217 
00218     <span class="keywordflow">return</span> 1;
00219 }
</pre></div><hr size="1"><address style="align: right;"><small>
Generated on Sat Aug 20 18:11:29 2005 for WikiAdventure by&nbsp;<a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.2</small></address>
</body>
</html>
