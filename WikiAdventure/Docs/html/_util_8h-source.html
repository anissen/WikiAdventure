<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>WikiAdventure: Project/Util.h Source File</title>
<link href="stylesheet.css" rel="stylesheet" type="text/css">
</head>

<body>
<!-- Generated by Doxygen 1.4.2 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<div class="nav">
<a class="el" href="dir_000001.html">Project</a></div>
<h1>Util.h</h1><a href="_util_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 
00002 
00003 <span class="preprocessor">#ifndef UTIL_H</span>
00004 <span class="preprocessor"></span><span class="preprocessor">#define UTIL_H</span>
00005 <span class="preprocessor"></span>
00006 <span class="preprocessor">#include &lt;vector&gt;</span>
00007 <span class="keyword">using</span> std::vector;
00008 
00009 <span class="preprocessor">#include &lt;string&gt;</span>
00010 <span class="keyword">using</span> std::string;
00011 
00012 <span class="preprocessor">#include "Shlwapi.h"</span>    <span class="comment">// For the PathFileExists function</span>
00013 <span class="preprocessor">#include &lt;direct.h&gt;</span>     <span class="comment">// For the mkdir-function</span>
00014 
00015 <span class="preprocessor">#include "../WA-SDL/Globals.h"</span>
00016 <span class="comment">//#include "Globals.h"</span>
00017 
<a name="l00024"></a><a class="code" href="_util_8h.html#a0">00024</a> <span class="keyword">static</span> string <a class="code" href="_util_8h.html#a0">GetTaggedText</a>( <span class="keyword">const</span> string&amp; sText, <span class="keyword">const</span> string&amp; sStartTag, <span class="keyword">const</span> string&amp; sEndTag )
00025 {
00026     size_t lStart = sText.find( sStartTag, 0 );
00027     <span class="keywordflow">if</span> ( lStart == string::npos ) 
00028     {
00029         <span class="keywordflow">return</span> string(<span class="stringliteral">""</span>);
00030     }
00031     
00032     <span class="comment">// Make sure that the start tag isn't included in the returned text</span>
00033     lStart += sStartTag.length();
00034     
00035     size_t lEnd = sText.find( sEndTag, lStart );
00036     <span class="keywordflow">if</span> ( lEnd == string::npos ) 
00037     {
00038         <span class="keywordflow">return</span> string(<span class="stringliteral">""</span>);
00039     }
00040     <span class="keywordflow">return</span> sText.substr( lStart, lEnd - lStart );
00041 }
00042 
<a name="l00048"></a><a class="code" href="_util_8h.html#a1">00048</a> <span class="keyword">static</span> string <a class="code" href="_util_8h.html#a0">GetTaggedText</a>( <span class="keyword">const</span> string&amp; sText, <span class="keyword">const</span> string&amp; sTag )
00049 {
00050     <span class="keywordflow">return</span> <a class="code" href="_util_8h.html#a0">GetTaggedText</a>( sText, <span class="stringliteral">"&lt;"</span> + sTag + <span class="stringliteral">"&gt;"</span>, <span class="stringliteral">"&lt;/"</span> + sTag + <span class="stringliteral">"&gt;"</span> );
00051 }
00052 
<a name="l00058"></a><a class="code" href="_util_8h.html#a2">00058</a> <span class="keyword">static</span> string <a class="code" href="_util_8h.html#a0">GetTaggedText</a>( <span class="keyword">const</span> string&amp; sText, <span class="keyword">const</span> string&amp; sStartTag, <span class="keyword">const</span> string&amp; sEndTag, <span class="keyword">const</span> string&amp; sDefault )
00059 {
00060     string sTemp = <a class="code" href="_util_8h.html#a0">GetTaggedText</a>( sText, sStartTag, sEndTag );
00061 
00062     <span class="keywordflow">if</span> ( sTemp.length() == 0 ) {
00063         <span class="keywordflow">return</span> sDefault;
00064     } <span class="keywordflow">else</span> {
00065         <span class="keywordflow">return</span> sTemp;
00066     }
00067 }
00068 
<a name="l00075"></a><a class="code" href="_util_8h.html#a3">00075</a> <span class="keyword">static</span> vector&lt;string&gt; <a class="code" href="_util_8h.html#a3">GetTaggedTextArray</a>( <span class="keyword">const</span> string&amp; sText, <span class="keyword">const</span> string&amp; sStartTag, <span class="keyword">const</span> string&amp; sEndTag )
00076 {
00077     vector&lt;string&gt; vTextArray;
00078     size_t lStart = 0;
00079     size_t lEnd  = 0;
00080     
00081     <span class="keywordflow">while</span>( true )
00082     {
00083         lStart = sText.find( sStartTag, lStart );
00084         <span class="keywordflow">if</span> ( lStart == string::npos ) 
00085         {
00086             <span class="keywordflow">break</span>;
00087         }
00088         
00089         <span class="comment">// Make sure that the start tag isn't included in the returned text</span>
00090         lStart += sStartTag.length();
00091         
00092         lEnd = sText.find( sEndTag, lStart );
00093         <span class="keywordflow">if</span> ( lEnd == string::npos ) 
00094         {
00095             <span class="keywordflow">break</span>;
00096         }
00097         
00098         vTextArray.push_back( sText.substr( lStart, lEnd - lStart ) );
00099     }
00100     <span class="keywordflow">return</span> vTextArray;
00101 }
00102 
<a name="l00108"></a><a class="code" href="_util_8h.html#a4">00108</a> <span class="keyword">static</span> vector&lt;string&gt; <a class="code" href="_util_8h.html#a3">GetTaggedTextArray</a>( <span class="keyword">const</span> string&amp; sText, <span class="keyword">const</span> string&amp; sTag )
00109 {
00110     <span class="keywordflow">return</span> <a class="code" href="_util_8h.html#a3">GetTaggedTextArray</a>( sText, <span class="stringliteral">"&lt;"</span> + sTag + <span class="stringliteral">"&gt;"</span>, <span class="stringliteral">"&lt;/"</span> + sTag + <span class="stringliteral">"&gt;"</span> );
00111 }
00112 
<a name="l00118"></a><a class="code" href="_util_8h.html#a5">00118</a> <span class="keyword">static</span> vector&lt;string&gt; <a class="code" href="_util_8h.html#a5">GetSeperatedTextArray</a>( <span class="keyword">const</span> string&amp; sText, <span class="keyword">const</span> string&amp; sSeparator )
00119 {
00120     vector&lt;string&gt; vTextArray;
00121     size_t lStart = 0;
00122     size_t lPos   = 0;
00123 
00124     <span class="keywordflow">while</span>( true )
00125     {
00126         lPos = sText.find( sSeparator, lStart );
00127         <span class="keywordflow">if</span> ( lPos == string::npos ) 
00128         {
00129             <span class="comment">// Put the text after the last separator into the array as well</span>
00130             vTextArray.push_back( sText.substr( lStart, sText.length() - lStart ) );
00131             <span class="keywordflow">break</span>;
00132         }
00133 
00134         vTextArray.push_back( sText.substr( lStart, lPos - lStart ) );
00135 
00136         lStart = lPos + sSeparator.length();
00137     }
00138     <span class="keywordflow">return</span> vTextArray;
00139 }
00140 
<a name="l00146"></a><a class="code" href="_util_8h.html#a6">00146</a> <span class="keyword">static</span> string <a class="code" href="_util_8h.html#a6">RemoveFromText</a>( <span class="keyword">const</span> string&amp; sText, <span class="keyword">const</span> string&amp; sRemove )
00147 {
00148     size_t lStart = 0;
00149     string sNewText = sText;
00150 
00151     <span class="keywordflow">while</span>( true )
00152     {
00153         lStart = sNewText.find( sRemove, lStart );
00154         <span class="keywordflow">if</span> ( lStart == string::npos ) 
00155             <span class="keywordflow">break</span>;
00156 
00157         sNewText.erase( lStart, sRemove.length() );
00158     }
00159     <span class="keywordflow">return</span> sNewText;
00160 }
00161 
<a name="l00168"></a><a class="code" href="_util_8h.html#a7">00168</a> <span class="keyword">static</span> string <a class="code" href="_util_8h.html#a7">ReplaceInText</a>( <span class="keyword">const</span> string&amp; sText, <span class="keyword">const</span> string&amp; sReplace, <span class="keyword">const</span> string&amp; sReplaceWith )
00169 {
00170     size_t lStart = 0;
00171     string sNewText = sText;
00172 
00173     <span class="keywordflow">while</span>( true )
00174     {
00175         lStart = sNewText.find( sReplace, lStart );
00176         <span class="keywordflow">if</span> ( lStart == string::npos ) 
00177             <span class="keywordflow">break</span>;
00178 
00179         sNewText.replace( lStart, sReplace.length(), sReplaceWith );
00180         lStart += sReplaceWith.length();
00181     }
00182     <span class="keywordflow">return</span> sNewText;
00183 }
00184 
<a name="l00188"></a><a class="code" href="_util_8h.html#a8">00188</a> <span class="keyword">static</span> string <a class="code" href="_util_8h.html#a8">ReplaceBR</a>( <span class="keyword">const</span> string&amp; sText )
00189 {
00190     <span class="keywordflow">return</span> <a class="code" href="_util_8h.html#a7">ReplaceInText</a>( <a class="code" href="_util_8h.html#a7">ReplaceInText</a>( sText, <span class="stringliteral">"&lt;br&gt;"</span>, <span class="stringliteral">"\n"</span> ), <span class="stringliteral">"[br]"</span>, <span class="stringliteral">"\n"</span> );
00191 }
00192 
<a name="l00198"></a><a class="code" href="_util_8h.html#a9">00198</a> <span class="keyword">static</span> string <a class="code" href="_util_8h.html#a9">GetAfterLast</a>( <span class="keyword">const</span> string&amp; sText, <span class="keyword">const</span> string&amp; sSeparator )
00199 {
00200     size_t lPos = sText.rfind( sSeparator, sText.length() );
00201 
00202     <span class="keywordflow">if</span> ( lPos == string::npos )
00203         <span class="keywordflow">return</span> string(<span class="stringliteral">""</span>);
00204 
00205     lPos += sSeparator.length();
00206     
00207     <span class="keywordflow">return</span> sText.substr( lPos, sText.length() - lPos );
00208 }
00209 
<a name="l00215"></a><a class="code" href="_util_8h.html#a10">00215</a> <span class="keyword">static</span> string <a class="code" href="_util_8h.html#a10">GetAfterFirst</a>( <span class="keyword">const</span> string&amp; sText, <span class="keyword">const</span> string&amp; sSeparator )
00216 {
00217     size_t lPos = sText.find( sSeparator, 0 );
00218 
00219     <span class="keywordflow">if</span> ( lPos == string::npos )
00220         <span class="keywordflow">return</span> string(<span class="stringliteral">""</span>);
00221 
00222     lPos += sSeparator.length();
00223 
00224     <span class="keywordflow">return</span> sText.substr( lPos, sText.length() - lPos );
00225 }
00226 
<a name="l00232"></a><a class="code" href="_util_8h.html#a11">00232</a> <span class="keyword">static</span> string <a class="code" href="_util_8h.html#a11">GetUntilLast</a>( <span class="keyword">const</span> string&amp; sText, <span class="keyword">const</span> string&amp; sSeparator )
00233 {
00234     size_t lPos = sText.rfind( sSeparator, sText.length() );
00235 
00236     <span class="keywordflow">if</span> ( lPos == string::npos )
00237         <span class="keywordflow">return</span> string(<span class="stringliteral">""</span>);
00238 
00239     <span class="keywordflow">return</span> sText.substr( 0, lPos );
00240 }
00241 
<a name="l00247"></a><a class="code" href="_util_8h.html#a12">00247</a> <span class="keyword">static</span> string <a class="code" href="_util_8h.html#a12">GetUntilFirst</a>( <span class="keyword">const</span> string&amp; sText, <span class="keyword">const</span> string&amp; sSeparator )
00248 {
00249     size_t lPos = sText.find( sSeparator, 0 );
00250 
00251     <span class="keywordflow">if</span> ( lPos == string::npos )
00252         <span class="keywordflow">return</span> string(<span class="stringliteral">""</span>);
00253 
00254     <span class="keywordflow">return</span> sText.substr( 0, lPos );
00255 }
00256 
<a name="l00261"></a><a class="code" href="_util_8h.html#a13">00261</a> <span class="keyword">static</span> string <a class="code" href="_util_8h.html#a13">RemoveLeadingSpaces</a>( <span class="keyword">const</span> string&amp; sText )
00262 {
00263     size_t lPos = sText.find_first_not_of( <span class="charliteral">' '</span> );
00264 
00265     <span class="keywordflow">if</span> ( lPos == string::npos )
00266         <span class="keywordflow">return</span> sText;
00267 
00268     <span class="keywordflow">return</span> sText.substr( lPos, sText.length() - lPos );
00269 }
00270 
<a name="l00271"></a><a class="code" href="_util_8h.html#a14">00271</a> <span class="keyword">static</span> BOOL <a class="code" href="_util_8h.html#a14">DoesMediaExist</a>( <span class="keyword">const</span> string&amp; sMediaFileName )
00272 {
00273     string sPath = <a class="code" href="_engine_main_8cpp.html#a0">g_sAppDir</a> + <span class="stringliteral">"\\Media\\"</span> + sMediaFileName;
00274     <span class="keywordflow">return</span> PathFileExists( sPath.c_str() );
00275 }
00276 
<a name="l00277"></a><a class="code" href="_util_8h.html#a15">00277</a> <span class="keyword">static</span> BOOL <a class="code" href="_util_8h.html#a15">DoesGameMediaExist</a>( <span class="keyword">const</span> string&amp; sGame, <span class="keyword">const</span> string&amp; sMediaFileName )
00278 {
00279     string sPath = <a class="code" href="_engine_main_8cpp.html#a0">g_sAppDir</a> + <span class="stringliteral">"\\Media\\"</span> + sGame + <span class="stringliteral">"\\"</span> + sMediaFileName;
00280     <span class="keywordflow">return</span> PathFileExists( sPath.c_str() );
00281 }
00282 
<a name="l00283"></a><a class="code" href="_util_8h.html#a16">00283</a> <span class="keyword">static</span> BOOL <a class="code" href="_util_8h.html#a16">DoesGameDirExist</a>( <span class="keyword">const</span> string&amp; sGame )
00284 {
00285     string sPath = <a class="code" href="_engine_main_8cpp.html#a0">g_sAppDir</a> + <span class="stringliteral">"\\Media\\"</span> + sGame;
00286     <span class="keywordflow">return</span> PathFileExists( sPath.c_str() );
00287 }
00288 
<a name="l00289"></a><a class="code" href="_util_8h.html#a17">00289</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="_util_8h.html#a17">CreateGameDir</a>( <span class="keyword">const</span> string&amp; sGame )
00290 {
00291     string sPath = <a class="code" href="_engine_main_8cpp.html#a0">g_sAppDir</a> + <span class="stringliteral">"\\Media\\"</span> + sGame;
00292     mkdir( sPath.c_str() );
00293 }
00294 
<a name="l00295"></a><a class="code" href="_util_8h.html#a18">00295</a> <span class="keyword">static</span> string <a class="code" href="_util_8h.html#a18">GetMediaPath</a>( <span class="keyword">const</span> string&amp; sGameDir, <span class="keyword">const</span> string&amp; sMediaFileName )
00296 {
00297     <span class="keywordflow">if</span> ( <a class="code" href="_util_8h.html#a15">DoesGameMediaExist</a>( sGameDir, sMediaFileName ) ) {
00298         <span class="keywordflow">return</span> <a class="code" href="_engine_main_8cpp.html#a0">g_sAppDir</a> + <span class="stringliteral">"\\Media\\"</span> + sGameDir + <span class="stringliteral">"\\"</span> + sMediaFileName;
00299     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="_util_8h.html#a15">DoesGameMediaExist</a>( <span class="stringliteral">"Default"</span>, sMediaFileName ) ) {
00300         <span class="keywordflow">return</span> <a class="code" href="_engine_main_8cpp.html#a0">g_sAppDir</a>  + <span class="stringliteral">"\\Media\\Default\\"</span> + sMediaFileName;
00301     } <span class="keywordflow">else</span> {
00302         <a class="code" href="_w_a-_s_d_l_2_globals_8h.html#a2">DebugInfo</a>( <a class="code" href="_w_a-_s_d_l_2_globals_8h.html#a12a8">TypeError</a>, string( <span class="stringliteral">"Media not found: "</span> + sMediaFileName ).c_str() ) ;
00303         <span class="keywordtype">int</span> x = 5; <span class="comment">// ERROR!</span>
00304         <span class="keywordflow">return</span> <a class="code" href="_engine_main_8cpp.html#a0">g_sAppDir</a> + <span class="stringliteral">"\\Media\\"</span> + sMediaFileName;
00305     }
00306 }
00307 
00308 <span class="comment">/*</span>
00309 <span class="comment">static string GetWikiPageContents( const string&amp; sPage, const string&amp; sTag, const string&amp; sFile, const long&amp; lLine )</span>
00310 <span class="comment">{</span>
00311 <span class="comment">    CWebPage Webpage;</span>
00312 <span class="comment">    if ( Webpage.DownloadWebPage( GetWikiPageURL( sPage ) ) == false )</span>
00313 <span class="comment">    {</span>
00314 <span class="comment">        DebugInfo( </span>
00315 <span class="comment">            "(Multiple)", </span>
00316 <span class="comment">            "GetWikiPageContents", </span>
00317 <span class="comment">            "Critical", </span>
00318 <span class="comment">            "Error occurred while trying to download web page.\nError: " + Webpage.GetError() + "\nApplication is aborting.",</span>
00319 <span class="comment">            sFile, lLine );</span>
00320 <span class="comment">        return string("");</span>
00321 <span class="comment">    }</span>
00322 <span class="comment"></span>
00323 <span class="comment">    return GetTaggedText( Webpage.GetContents(), sTag );</span>
00324 <span class="comment">}</span>
00325 <span class="comment">*/</span>
00326 
00327 <span class="preprocessor">#endif // UTIL_H</span>
</pre></div><hr size="1"><address style="align: right;"><small>
Generated on Sat Aug 20 18:11:29 2005 for WikiAdventure by&nbsp;<a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.2</small></address>
</body>
</html>
